<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:models="clr-namespace:MobileAppProject.Models"
             xmlns:viewmodels="clr-namespace:MobileAppProject.ViewModels"
             x:Class="MobileAppProject.Views.FavouritesPage"
             x:Name="PageRoot"
             Title="Favourites"
             Shell.NavBarIsVisible="False"
             BackgroundColor="{AppThemeBinding Light={StaticResource White}, Dark={StaticResource PrimaryDark}}">

    <ScrollView>
        <VerticalStackLayout Padding="15">

            <!-- Header -->
            <Grid ColumnDefinitions="*,Auto" Padding="0,0,0,8">
                <Label Text="Go Back"   
                   FontAttributes="Bold"
                   FontSize="18"
                   VerticalOptions="Center"
                   HorizontalOptions="Start"
                   TextColor="{AppThemeBinding Light={StaticResource TextPrimary}, Dark={StaticResource White}}">
                    <Label.GestureRecognizers>
                        <TapGestureRecognizer Tapped="OnBackClicked"/>
                    </Label.GestureRecognizers>
                </Label>
            </Grid>

            <!-- Favourites List -->
            <CollectionView ItemsSource="{Binding Favourites}"
                SelectionMode="Single"
                SelectionChanged="CollectionView_SelectionChanged">
                <CollectionView.ItemTemplate>
                    <DataTemplate x:DataType="models:RecipeItem">
                        <Border Margin="6" StrokeShape="RoundRectangle 12" Padding="8"
                    BackgroundColor="{AppThemeBinding Light={StaticResource SoftYellow}, Dark={StaticResource AccentOrange}}">
                            <Grid ColumnDefinitions="100,*">
                                <Grid.GestureRecognizers>
                                    <TapGestureRecognizer 
                            Command="{Binding BindingContext.SelectRecipeCommand, Source={x:Reference PageRoot}}"
                            CommandParameter="{Binding .}" />
                                </Grid.GestureRecognizers>

                                <Image Source="{Binding ImageFile}" Aspect="AspectFill" HeightRequest="80" WidthRequest="100"/>
                                <StackLayout Grid.Column="1" Padding="8,0" VerticalOptions="Center">
                                    <Label Text="{Binding Title}" FontAttributes="Bold" FontSize="16"/>
                                    <Label Text="{Binding ShortDescription}" LineBreakMode="TailTruncation" MaxLines="2"/>
                                </StackLayout>
                            </Grid>
                        </Border>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>
        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
